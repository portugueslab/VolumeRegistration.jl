<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · VolumeRegistration.jl</title><link rel="canonical" href="https://portugueslab.github.io/VolumeRegistration.jl/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">VolumeRegistration.jl</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/portugueslab/VolumeRegistration.jl/blob/master/docs/src/index.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="VolumeRegistration-1"><a class="docs-heading-anchor" href="#VolumeRegistration-1">VolumeRegistration</a><a class="docs-heading-anchor-permalink" href="#VolumeRegistration-1" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="VolumeRegistration.apply_deformation_map-Union{Tuple{M}, Tuple{TS}, Tuple{N}, Tuple{T}, Tuple{AbstractArray{T,M},Array{Array{Tuple{Vararg{TS,N}},N},N1} where N1,Any}} where M where TS where N where T" href="#VolumeRegistration.apply_deformation_map-Union{Tuple{M}, Tuple{TS}, Tuple{N}, Tuple{T}, Tuple{AbstractArray{T,M},Array{Array{Tuple{Vararg{TS,N}},N},N1} where N1,Any}} where M where TS where N where T"><code>VolumeRegistration.apply_deformation_map</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">apply_deformation_map(moving, shifts, blocks; spline_type)
</code></pre><p>Corrects a sequence of imaging stacks with a transformation found through non-rigid registration</p><p>optionally, specify the <code>spline_type</code> for interpolations between found shifts other than linear</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/portugueslab/VolumeRegistration.jl/blob/246b82226cbc277f7316d5b63a18f02b055ffcb1/src/transformation.jl#LL138-L145">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VolumeRegistration.apply_deformation_map-Union{Tuple{TS}, Tuple{N}, Tuple{T}, Tuple{AbstractArray{T,N},AbstractArray{Tuple{Vararg{TS,N}},N},Any}} where TS where N where T" href="#VolumeRegistration.apply_deformation_map-Union{Tuple{TS}, Tuple{N}, Tuple{T}, Tuple{AbstractArray{T,N},AbstractArray{Tuple{Vararg{TS,N}},N},Any}} where TS where N where T"><code>VolumeRegistration.apply_deformation_map</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Corrects a plane or volume with a transformation found through non-rigid registration</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/portugueslab/VolumeRegistration.jl/blob/246b82226cbc277f7316d5b63a18f02b055ffcb1/src/transformation.jl#LL112-L115">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VolumeRegistration.find_deformation_map-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T,N},AbstractArray{T,N}}} where N where T" href="#VolumeRegistration.find_deformation_map-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T,N},AbstractArray{T,N}}} where N where T"><code>VolumeRegistration.find_deformation_map</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Find deformation maps by splitting the dataset in blocks and aligning blocks with subpixel precision</p><p><strong>Arguments</strong></p><ul><li><code>moving</code>: the stack to be registered</li><li><code>reference</code>: the stack to be registered to</li><li><code>border_σ</code>: how far to fade out the borders of the whole image/volume</li><li><code>block_size::NTuple{N, Integer}</code>: size of blocks to compute deformations</li><li><code>block_border_σ::Union{Real, NTuple{N, Real}}</code>: how far to fade out the</li><li><code>max_shift::Union{Real, NTuple{N, Integer}}</code>: maximum displacement of a block in each dimension</li><li><code>σ_filter</code>: low-pass filter width</li><li><code>upsampling</code>: upsampling of the registration for subpixel alignment</li><li><code>upsample_padding</code>: how far to pad from the local maximum for upsampling</li><li><code>snr_n_smooths::Integer=2</code>: number of times the correlation matrices are smoothed by wieghting with adjacent ones (if they are under signal-to-noise ratio)</li><li><code>snr_threshold::Real</code>: the threshold of the &quot;peakiness&quot; of the correlation matrix, if it&#39;s smaller than that, it&#39;s value is obtained by smoothing neighbors</li><li><code>snr_n_pad::Integer</code>: window size of the signal-to-noise calculation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/portugueslab/VolumeRegistration.jl/blob/246b82226cbc277f7316d5b63a18f02b055ffcb1/src/nonrigid.jl#LL220-L238">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VolumeRegistration.find_translation-Union{Tuple{T}, Tuple{M}, Tuple{N}, Tuple{AbstractArray{T,M},AbstractArray{T,N}}} where T where M where N" href="#VolumeRegistration.find_translation-Union{Tuple{T}, Tuple{M}, Tuple{N}, Tuple{AbstractArray{T,M},AbstractArray{T,N}}} where T where M where N"><code>VolumeRegistration.find_translation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">find_translation(movings, reference; interpolate_middle, kwargs...)
</code></pre><p>Find the shift to move <code>moving</code> by to align with <code>reference</code></p><p><strong>Arguments</strong></p><ul><li><code>σ_filter</code>: standard deviation of a lowpass filter applied before finding translation</li><li><code>max_shift::Union{Integer, Tuple}</code>: the maximal shift in each dimension </li><li><code>border_σ</code>: the width of the border kernel for a smooth faloff towards the edges</li><li><code>upsampling::Union{Integer, Tuple}=1</code>: If bigger than 1, how much to upsample the shifts by (for subpixel registration)</li><li><code>upsample_padding::Union{Integer, Tuple}=nothing</code> how much ± pixels to take around maximum to upsample</li><li><code>interpolate_middle::Bool</code>: whether to interpolate the middle correlation pixel (to avoid static camera noise)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/portugueslab/VolumeRegistration.jl/blob/246b82226cbc277f7316d5b63a18f02b055ffcb1/src/translation.jl#LL70-L83">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VolumeRegistration.make_planewise_reference-Tuple{Any}" href="#VolumeRegistration.make_planewise_reference-Tuple{Any}"><code>VolumeRegistration.make_planewise_reference</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">make_planewise_reference(stack; reference_kw...)
</code></pre><p>Make a plane-by-plane reference for 2-photon imaging data.  The keyword arguments are from <a href="#VolumeRegistration.find_translation-Union{Tuple{T}, Tuple{M}, Tuple{N}, Tuple{AbstractArray{T,M},AbstractArray{T,N}}} where T where M where N"><code>find_translation</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/portugueslab/VolumeRegistration.jl/blob/246b82226cbc277f7316d5b63a18f02b055ffcb1/src/pipelines.jl#LL136-L142">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VolumeRegistration.make_reference-Tuple{Any}" href="#VolumeRegistration.make_reference-Tuple{Any}"><code>VolumeRegistration.make_reference</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">make_reference(stack; kwargs...)</code></pre><p>Make a reference for a stack</p><p><strong>Arguments</strong></p><ul><li><code>stack</code>: the data to be aligned, time is assumed to be the list dimension</li><li><code>time_range::AbstractUnitRange=Colon()</code>: the range of time to take the reference from</li><li><code>corr_win</code>: size of the window around the middle of the stack to calculate the optimal reference</li><li><code>n_refine_from</code>: how many frames to make the refined reference from</li><li><code>n_average</code>: number of frames to average for a nice reference</li><li><code>n_iterations</code>: how many times to recalculate the reference from the best correlated moved frames</li></ul><p>more keyword arguments for (@ref find_translation) can be supplied</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/portugueslab/VolumeRegistration.jl/blob/246b82226cbc277f7316d5b63a18f02b055ffcb1/src/reference.jl#LL63-L78">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VolumeRegistration.register_planewise!-Tuple{Any,Any,Any}" href="#VolumeRegistration.register_planewise!-Tuple{Any,Any,Any}"><code>VolumeRegistration.register_planewise!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">register_planewise!(destination, stack, reference; output_time_first, translation_kw...)
</code></pre><p>Registers a stack of data acquired plane-by-plane The keyword arguments are from <a href="#VolumeRegistration.find_translation-Union{Tuple{T}, Tuple{M}, Tuple{N}, Tuple{AbstractArray{T,M},AbstractArray{T,N}}} where T where M where N"><code>find_translation</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/portugueslab/VolumeRegistration.jl/blob/246b82226cbc277f7316d5b63a18f02b055ffcb1/src/pipelines.jl#LL169-L175">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VolumeRegistration.register_volumes!-Tuple{Any,Any,Any}" href="#VolumeRegistration.register_volumes!-Tuple{Any,Any,Any}"><code>VolumeRegistration.register_volumes!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">register_volumes!(destination, dataset, reference; max_shift_rigid, σ_filter_rigid, border_σ_rigid, interpolate_middle_rigid, max_shift_nonrigid, σ_filter_nonrigid, border_σ_nonrigid, block_border_σ, block_size, upsampling, snr_n_smooths, snr_threshold, interpolate_middle_nonrigid, t_block_size, output_time_first, interpolation_nonrigid)
</code></pre><p>Register volumes, by first finding a rigid translationa and then applying non-rigid shifts</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/portugueslab/VolumeRegistration.jl/blob/246b82226cbc277f7316d5b63a18f02b055ffcb1/src/pipelines.jl#LL1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VolumeRegistration.translate-Union{Tuple{T}, Tuple{N}, Tuple{AbstractArray{T,N},CoordinateTransformations.Translation}, Tuple{AbstractArray{T,N},CoordinateTransformations.Translation,Any}} where T where N" href="#VolumeRegistration.translate-Union{Tuple{T}, Tuple{N}, Tuple{AbstractArray{T,N},CoordinateTransformations.Translation}, Tuple{AbstractArray{T,N},CoordinateTransformations.Translation,Any}} where T where N"><code>VolumeRegistration.translate</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Translate an image by known shift using either reindexing (for integer shifts) of FFT-based phase-space translation for non-integer shifts.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/portugueslab/VolumeRegistration.jl/blob/246b82226cbc277f7316d5b63a18f02b055ffcb1/src/transformation.jl#LL61-L66">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VolumeRegistration.KrigingUpsampler-Tuple{}" href="#VolumeRegistration.KrigingUpsampler-Tuple{}"><code>VolumeRegistration.KrigingUpsampler</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Construct an upsampler with its matrix</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/portugueslab/VolumeRegistration.jl/blob/246b82226cbc277f7316d5b63a18f02b055ffcb1/src/kriging.jl#LL12-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VolumeRegistration.calc_snr-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T,N},Any}} where N where T" href="#VolumeRegistration.calc_snr-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T,N},Any}} where N where T"><code>VolumeRegistration.calc_snr</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Computes the signal to noise ratio of a phase correlation array, defined as the ratio of the maximum phase correlation in the window divided by the maximal phase correlation outside of the region where the maximum is (the idea  being that it will be low if the phase correlation is flat versus peaked)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/portugueslab/VolumeRegistration.jl/blob/246b82226cbc277f7316d5b63a18f02b055ffcb1/src/nonrigid.jl#LL68-L75">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VolumeRegistration.extract_low_frequencies-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{Complex{T},N},Tuple{Vararg{Integer,N}}}, Tuple{AbstractArray{Complex{T},N},Tuple{Vararg{Integer,N}},Any}} where N where T" href="#VolumeRegistration.extract_low_frequencies-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{Complex{T},N},Tuple{Vararg{Integer,N}}}, Tuple{AbstractArray{Complex{T},N},Tuple{Vararg{Integer,N}},Any}} where N where T"><code>VolumeRegistration.extract_low_frequencies</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Takes the data corresponding to the real part of the corners of the  phase correlation array of interest for shift finding</p><pre><code class="language-julia">extract_low_frequencies(data, corner_size)
extract_low_frequencies(data, corner_size, interpolate_middle)
</code></pre><p><strong>Arugments</strong></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/portugueslab/VolumeRegistration.jl/blob/246b82226cbc277f7316d5b63a18f02b055ffcb1/src/phase_correlation.jl#LL50-L59">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VolumeRegistration.fft_translate-Union{Tuple{T}, Tuple{N}, Tuple{AbstractArray{T,N},Any}} where T&lt;:Complex where N" href="#VolumeRegistration.fft_translate-Union{Tuple{T}, Tuple{N}, Tuple{AbstractArray{T,N},Any}} where T&lt;:Complex where N"><code>VolumeRegistration.fft_translate</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Translate using discrete fourier transform</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/portugueslab/VolumeRegistration.jl/blob/246b82226cbc277f7316d5b63a18f02b055ffcb1/src/transformation.jl#LL9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VolumeRegistration.gaussian_fft_filter-Union{Tuple{T}, Tuple{N}, Tuple{Tuple{Vararg{Integer,N}},Union{Tuple{Vararg{T,N}}, T}}} where T where N" href="#VolumeRegistration.gaussian_fft_filter-Union{Tuple{T}, Tuple{N}, Tuple{Tuple{Vararg{Integer,N}},Union{Tuple{Vararg{T,N}}, T}}} where T where N"><code>VolumeRegistration.gaussian_fft_filter</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Gaussian filter in the fourier domain (a Gaussian in the fourier domain is again a gaussian with inverse variance)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/portugueslab/VolumeRegistration.jl/blob/246b82226cbc277f7316d5b63a18f02b055ffcb1/src/phase_correlation.jl#LL5-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VolumeRegistration.prepare_find_deformation_map-Union{Tuple{AbstractArray{T,N}}, Tuple{N}, Tuple{T}} where N where T" href="#VolumeRegistration.prepare_find_deformation_map-Union{Tuple{AbstractArray{T,N}}, Tuple{N}, Tuple{T}} where N where T"><code>VolumeRegistration.prepare_find_deformation_map</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Prepare everything common for calculating deformation maps</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/portugueslab/VolumeRegistration.jl/blob/246b82226cbc277f7316d5b63a18f02b055ffcb1/src/nonrigid.jl#LL112-L115">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VolumeRegistration.prepare_find_translation-Union{Tuple{AbstractArray{T,N}}, Tuple{N}, Tuple{T}} where N where T" href="#VolumeRegistration.prepare_find_translation-Union{Tuple{AbstractArray{T,N}}, Tuple{N}, Tuple{T}} where N where T"><code>VolumeRegistration.prepare_find_translation</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Prepare everything common for all translations</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/portugueslab/VolumeRegistration.jl/blob/246b82226cbc277f7316d5b63a18f02b055ffcb1/src/translation.jl#LL1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VolumeRegistration.refine_reference-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T,N},Any}} where N where T" href="#VolumeRegistration.refine_reference-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T,N},Any}} where N where T"><code>VolumeRegistration.refine_reference</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Iterative refinement of a reference image by aligning more frames and then making a new reference out of the most correlated, aligned frames</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/portugueslab/VolumeRegistration.jl/blob/246b82226cbc277f7316d5b63a18f02b055ffcb1/src/reference.jl#LL34-L38">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VolumeRegistration.split_into_blocks-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T,N},PaddedBlocks.Blocks{N}}, Tuple{AbstractArray{T,N},PaddedBlocks.Blocks{N},Any}} where N where T" href="#VolumeRegistration.split_into_blocks-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T,N},PaddedBlocks.Blocks{N}}, Tuple{AbstractArray{T,N},PaddedBlocks.Blocks{N},Any}} where N where T"><code>VolumeRegistration.split_into_blocks</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Splits data into an array of blocks, augmenting the last blocks which may not be full to keep consistent size. Cast immediately into complex for further processing</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/portugueslab/VolumeRegistration.jl/blob/246b82226cbc277f7316d5b63a18f02b055ffcb1/src/nonrigid.jl#LL20-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VolumeRegistration.to_ntuple-Union{Tuple{N}, Tuple{Val{N},Number}} where N" href="#VolumeRegistration.to_ntuple-Union{Tuple{N}, Tuple{Val{N},Number}} where N"><code>VolumeRegistration.to_ntuple</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Small utilities to get window size from iterables or single number</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/portugueslab/VolumeRegistration.jl/blob/246b82226cbc277f7316d5b63a18f02b055ffcb1/src/utilities.jl#LL1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VolumeRegistration.upsampled_shift-Union{Tuple{AT}, Tuple{N}, Tuple{T}, Tuple{VolumeRegistration.KrigingUpsampler{N,AT},AbstractArray{T,N}}} where AT where N where T" href="#VolumeRegistration.upsampled_shift-Union{Tuple{AT}, Tuple{N}, Tuple{T}, Tuple{VolumeRegistration.KrigingUpsampler{N,AT},AbstractArray{T,N}}} where AT where N where T"><code>VolumeRegistration.upsampled_shift</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Finds the shift in the area around the center of the orignial window with  upsampling</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/portugueslab/VolumeRegistration.jl/blob/246b82226cbc277f7316d5b63a18f02b055ffcb1/src/kriging.jl#LL56-L59">source</a></section></article></article></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 11 June 2020 21:03">Thursday 11 June 2020</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
